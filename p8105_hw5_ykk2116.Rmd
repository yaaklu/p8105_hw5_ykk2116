---
title: "P8105_hw5_ykk2116"
author: "Yaa Klu"
date: "11/6/2018"
output: github_document
---

_Loading tidyverse and rvest_

```{r}
library(tidyverse)
library(plotly)
library(rvest)
```


### Problem 1


_Making dataframe containing all file names_

```{r}
allfiles_df = tibble(filepath = list.files("./data/", pattern = "*.csv", full.names = TRUE),
                     filename = basename(filepath))
```


_Function for data_

```{r}
data_reading = function(data){
  
  read_csv(file = data)
}
```


_Iterating and reading in data for each subject, data cleaning_

```{r, message=FALSE}
data_f = allfiles_df %>% mutate(data = purrr::map(allfiles_df$filepath, data_reading)) %>%
  unnest() %>% 
  select(-filepath) %>%
  gather(key = week, value = value, week_1:week_8) %>%
   mutate(id = str_replace(filename, ".csv",""),
         week = as.numeric(str_replace(week, "week_", ""))) %>%
    separate(id, into = c("group", "id"), sep = "_") %>% 
  mutate(id = as.factor(id))  
``` 

_Spaghetti Graph_

```{r}
ggplot(data_f, aes(x = week, y = value, color = id, group = id)) + geom_point() + geom_line() + facet_grid(~group) +
  scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6, 7, 8)) +
  labs(
     title = "Observations from each subject over a period of eight weeks",
    x = "Week",
    y = "Observation Value"
  )
```

_Differences between experimental and control groups_

**Looking at all control subjects as a group, there was no clear trend with time. Overall it seems that there was no difference between observations at week 1 and week 8. In between the 8 weeks there were random increases and decreases among specific subjects. In the experimental arm, there was an increase in the observation value from week 1 to week 8. In between the 8 weeks, there were some ups and downs just as was observed in the control group. To conclude, the values of observation were higher in the experimental arm after 8 weeks, whiles in the control arm, there was no increase**



### Problem 2

_Reading data and creating variable_


```{r}
homicide_data = read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv", col_names = TRUE) %>% 
  mutate(city_state = str_c(city, ",", " ", state))
```

_Description of data_

**

